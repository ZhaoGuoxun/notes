#### web高级-性能调优  

> 说明：不是适合于所有的浏览器；不能一概而论(根据某些浏览器具体设置)；只适用于最近的阶段

#####  浏览器功能与组成

1. 浏览器内核

   ```tex
   IE	Trident
   Safari	WebKit
   Chrome	Blink（WebKit的分支）
   Opera	v4-v6:Elektra 7.x:presto 2013.2:chromium -> Blink
   Firefox	Gecko
   ```

2. 进程与线程

   JS引擎是单线程运行的  由各个模块负责分线程管理

3. 现代浏览器：多进程 多线程

   1. 浏览器有哪些进程

      - Browser进程

      - Renderer进程

      - 各种插件进程

      - GPU进程

4. 为了不让其他操作阻止渲染线程的高速执行,我们通常会将渲染过程【管线化】     

###### 浏览器渲染引擎

###### 主要模块

1. HTML 解析器	--> DOM 树
2. CSS 解析器   --> CSS 样式树
3. JavaScript 引擎  
4. 布局（layout）
5. 绘图模块（paint）  

> 其他模块： 网络  存储 2D/3D图像  音视频解码器  和 图片解码器
>
> DOM树 与 CSS树 合并成一个渲染树

```txt
style 标签中的样式有 html 解析器进行解析
浏览器加载资源是异步的
页面 style 标签写的内部样式是异步解析的
```

###### 阻塞渲染

1. 关于 css 阻塞

```txt
link 引入的样式文件 是由css解析器去解析的，并且是同步解析的
css解析器会阻塞页面的渲染（利用link标签的引入来解决闪屏的问题）
阻塞其后面的js语句的执行
不阻塞 DOM 解析，这是两个并行的进程 最终生成 render tree
推荐使用 link 方式引入样式
```

优化核心理念：尽可能快的提高外部css加载速度

```txt
1. 使用CDN节点进行外部资源加速
2. 对css进行压缩
3. 减少http请求数，将多个css文件合并
4. 优化样式表的代码
```

2. 关于 js 阻塞

```txt
js 阻塞 DOM 解析
阻塞页面渲染
阻塞后续 js 的执行
script 标签添加 defer 属性，页面渲染完成触发 defer 的引入的 js
```

##### 优化重绘重排

1. 使用文档碎片

2. 将DOM离线后再操作

3. 不要循环获取DOM节点的宽高或者位置属性

   > 为了展示最新的数据，浏览器会发生一次重绘和重排

4. 动画的元素为其开启一个图层 或者提高元素的 z-index

   > 如果不开启图层，会对整个DOM不停的做重绘重排

##### 函数防抖与函数节流

###### 函数防抖：

> 延时脚本执行  常用于输入框

###### 函数节流

> 固定的时间间隔内，只会触发一次   常用于scroll监听事件

##### CDN

1. 安全 防止DDOS攻击 （几秒内发起数亿次的请求）
2. 选择距离最近的服务器 

##### 浏览器存储

###### Cookie

HttpOnly 为避免跨域脚本(XSS攻击)

为什么使用： http是无状态的

###### SessionStorage

###### LocalStorage

##### 强缓存

##### 协商缓存

```txt
last-modified / if-modified-since
etag / if-none-match
```



